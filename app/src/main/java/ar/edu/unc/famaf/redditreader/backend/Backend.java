package ar.edu.unc.famaf.redditreader.backend;

import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import ar.edu.unc.famaf.redditreader.model.PostModel;

public class Backend {
    private static final String TAG = "redditreader.backend";
    private static final String END_POINT = "https://www.reddit.com/";
    private static Backend ourInstance = new Backend();
    private String response = "{\"kind\": \"Listing\", \"data\": {\"modhash\": \"\", \"children\": [{\"kind\": \"t3\", \"data\": {\"contest_mode\": false, \"banned_by\": null, \"domain\": \"imgur.com\", \"subreddit\": \"pics\", \"selftext_html\": null, \"selftext\": \"\", \"likes\": null, \"suggested_sort\": null, \"user_reports\": [], \"secure_media\": null, \"saved\": false, \"id\": \"5a5knt\", \"gilded\": 0, \"secure_media_embed\": {}, \"clicked\": false, \"report_reasons\": null, \"author\": \"viewerdoer\", \"media\": null, \"name\": \"t3_5a5knt\", \"score\": 6595, \"approved_by\": null, \"over_18\": false, \"removal_reason\": null, \"hidden\": false, \"preview\": {\"images\": [{\"source\": {\"url\": \"https://i.redditmedia.com/Tz9EK9SeUHJA8Jcjk9p1iWsYE3i-f0LoLEMnat7wlUM.jpg?s=0347d6293eec95076100758721c1e394\", \"width\": 606, \"height\": 576}, \"resolutions\": [{\"url\": \"https://i.redditmedia.com/Tz9EK9SeUHJA8Jcjk9p1iWsYE3i-f0LoLEMnat7wlUM.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;s=9b03edc7ed999d6c7d47be3e8c98aca6\", \"width\": 108, \"height\": 102}, {\"url\": \"https://i.redditmedia.com/Tz9EK9SeUHJA8Jcjk9p1iWsYE3i-f0LoLEMnat7wlUM.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;s=dfaa960de4bd5c187c431ff6820730e1\", \"width\": 216, \"height\": 205}, {\"url\": \"https://i.redditmedia.com/Tz9EK9SeUHJA8Jcjk9p1iWsYE3i-f0LoLEMnat7wlUM.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=320&amp;s=a7465a72f6b436d339869807be6c6d05\", \"width\": 320, \"height\": 304}], \"variants\": {}, \"id\": \"bNYTNgGpBOEU0OmsdtKlghk7pNJjOLvGim8mgXkNdvY\"}]}, \"thumbnail\": \"http://a.thumbs.redditmedia.com/P7mznj0nTqZuwiGML3mNq63nySxlFJhwhPIl0zKsQF0.jpg\", \"subreddit_id\": \"t5_2qh0u\", \"edited\": false, \"link_flair_css_class\": null, \"author_flair_css_class\": null, \"downs\": 0, \"mod_reports\": [], \"archived\": false, \"media_embed\": {}, \"post_hint\": \"link\", \"is_self\": false, \"hide_score\": false, \"spoiler\": false, \"permalink\": \"/r/pics/comments/5a5knt/i_hung_up_this_picture_that_depicts_the_four/\", \"locked\": false, \"stickied\": false, \"created\": 1477854765.0, \"url\": \"http://imgur.com/mYNnEYF\", \"author_flair_text\": null, \"quarantine\": false, \"title\": \"I hung up this picture that depicts the four seasons based on the angle you view it from. Hung it up next to a mirror for added coolness.\", \"created_utc\": 1477825965.0, \"link_flair_text\": null, \"distinguished\": null, \"num_comments\": 595, \"visited\": false, \"num_reports\": null, \"ups\": 6595}}, {\"kind\": \"t3\", \"data\": {\"contest_mode\": false, \"banned_by\": null, \"domain\": \"self.gaming\", \"subreddit\": \"gaming\", \"selftext_html\": \"&lt;!-- SC_OFF --&gt;&lt;div class=\\\"md\\\"&gt;&lt;p&gt;I live in Myanmar, and I own about 20 games on Origin, and have spent hundreds of dollars on the platform. I&amp;#39;ve bought the full editions of all of the Battlefield games up to this point, with their season passes. I was trying to log into Origin a few days ago, and got a bizarre &amp;quot;Access Denied&amp;quot; message. I googled it, and found that &amp;quot;Origin is no longer available in Myanmar.&amp;quot; &lt;/p&gt;\\n\\n&lt;p&gt;&lt;a href=\\\"http://answers.ea.com/t5/Origin/New-Origin-Access-Denied-from-Myanmar/m-p/5572204/highlight/true#M220895\\\"&gt;http://answers.ea.com/t5/Origin/New-Origin-Access-Denied-from-Myanmar/m-p/5572204/highlight/true#M220895&lt;/a&gt;&lt;/p&gt;\\n\\n&lt;p&gt;&lt;a href=\\\"http://answers.ea.com/t5/Origin/ISP-IP-blocked-by-EA/m-p/5588812/highlight/true#M222597\\\"&gt;http://answers.ea.com/t5/Origin/ISP-IP-blocked-by-EA/m-p/5588812/highlight/true#M222597&lt;/a&gt;&lt;/p&gt;\\n\\n&lt;p&gt;&lt;del&gt;Supposedly EA is blaming this on complying with US sanctions against Myanmar (which is total crap, considering Steam, GOG, and every single other content distribution network is just fine). Additionally, sanctions were lifted on October 7th.&lt;/del&gt; The response from the Origin Champion was: &amp;quot;with the Origin 10 update, US laws (which is where EA is based) forced them to block certain countries. Unfortunately you live in one of those countries. I&amp;#39;m sorry but there is nothing we ca do here to allow you access again.&amp;quot; Still no access to our games that we bought. &lt;del&gt;EDIT: Evidently I confused an EA champion with a random person chipping in inside the thread. We don&amp;#39;t know why Myanmar has been terminated. Just that we have no access anymore and that according to the champion, Origin is no longer supported in Myanmar.&lt;/del&gt; Edit Edit: Nevermind, it&amp;#39;s the second link. They said &amp;quot;...with the Origin 10 update, US laws (which is where EA is based) forced them to block certain countries. Unfortunately you live in one of those countries. I&amp;#39;m sorry but there is nothing we ca do here to allow you access again.&amp;quot; So I&amp;#39;m making a (hopefully pretty safe) assumption that it&amp;#39;s because of sanctions.&lt;/p&gt;\\n\\n&lt;p&gt;None of us has been offered a refund - not even a &amp;quot;sorry, all your games are gone.&amp;quot; &lt;/p&gt;\\n\\n&lt;p&gt;Remember, if they do it to me, they can do it to you too. Don&amp;#39;t use or buy games from Origin or DRM services. They can take your content away without offering a refund.&lt;/p&gt;\\n\\n&lt;p&gt;Edit: I feel like this is something that the entire gaming community needs to know about - I don&amp;#39;t think that revoking access to an entire country&amp;#39;s worth of people&amp;#39;s paid content is something that should happen quietly. PLEASE spread the word about this. We in Myanmar need your help to get our games back!&lt;/p&gt;\\n\\n&lt;p&gt;Edit edit: Wow, this blew up to #1 on the frontpage. Although I probably shouldn&amp;#39;t be surprised since EA + DRM + getting games pulled is a Reddit recipe for success. Since it&amp;#39;s blown up so much, I feel the need to clarify a few things that I now realize are not clear from the comments.&lt;/p&gt;\\n\\n&lt;ol&gt;\\n&lt;li&gt;I live in Myanmar, but I am not from Myanmar.&lt;/li&gt;\\n&lt;li&gt;My account was not started in Myanmar (though several of my friends&amp;#39; accounts were, and they are having the same problem).&lt;/li&gt;\\n&lt;li&gt;Origin is kicking an &amp;quot;Access Denied&amp;quot; message to all of us. You can&amp;#39;t access ANY games or even see the store. Click the links above for examples. If we use VPNs, we can circumvent this and access our games (although we can&amp;#39;t play online due to insane ping - baseline here is 100ms; you use a VPN you go to 350+).&lt;/li&gt;\\n&lt;li&gt;Myanmar&amp;#39;s sanctions were lifted on October 7th. For those of you that say EA has no choice, they do. &lt;/li&gt;\\n&lt;li&gt;We were all able to access Origin in early September. Obama announced that the sanctions were being lifted from Myanmar. Right around the time of the announcement, EA terminates all Myanmar access to Origin.&lt;/li&gt;\\n&lt;/ol&gt;\\n\\n&lt;p&gt;This is a much, MUCH bigger problem than just a few gamers in Myanmar. This highlights a crucial element of the TOS of big game companies - the money that you pay them gives you essentially nothing in return, except for an empty promise that the game company may let you play their game until they decide you can&amp;#39;t. &lt;/p&gt;\\n\\n&lt;p&gt;Edit edit edit: I&amp;#39;m waiting on the &amp;quot;Thank you for contacting EA&amp;quot; screen. My wait time is under 5 minutes!&lt;/p&gt;\\n\\n&lt;p&gt;Edit edit edit edit: It&amp;#39;s been 20 minutes. But the good news is my wait time is STILL under 5 minutes!&lt;/p&gt;\\n\\n&lt;p&gt;Edit&lt;sup&gt;5:&lt;/sup&gt; No &amp;quot;experts&amp;quot; available, so they can&amp;#39;t give me a definitive answer today. They&amp;#39;ll have to get back to me tomorrow.&lt;/p&gt;\\n&lt;/div&gt;&lt;!-- SC_ON --&gt;\", \"selftext\": \"I live in Myanmar, and I own about 20 games on Origin, and have spent hundreds of dollars on the platform. I've bought the full editions of all of the Battlefield games up to this point, with their season passes. I was trying to log into Origin a few days ago, and got a bizarre \\\"Access Denied\\\" message. I googled it, and found that \\\"Origin is no longer available in Myanmar.\\\" \\n\\nhttp://answers.ea.com/t5/Origin/New-Origin-Access-Denied-from-Myanmar/m-p/5572204/highlight/true#M220895\\n\\nhttp://answers.ea.com/t5/Origin/ISP-IP-blocked-by-EA/m-p/5588812/highlight/true#M222597\\n\\n~~Supposedly EA is blaming this on complying with US sanctions against Myanmar (which is total crap, considering Steam, GOG, and every single other content distribution network is just fine). Additionally, sanctions were lifted on October 7th.~~ The response from the Origin Champion was: \\\"with the Origin 10 update, US laws (which is where EA is based) forced them to block certain countries. Unfortunately you live in one of those countries. I'm sorry but there is nothing we ca do here to allow you access again.\\\" Still no access to our games that we bought. ~~EDIT: Evidently I confused an EA champion with a random person chipping in inside the thread. We don't know why Myanmar has been terminated. Just that we have no access anymore and that according to the champion, Origin is no longer supported in Myanmar.~~ Edit Edit: Nevermind, it's the second link. They said \\\"...with the Origin 10 update, US laws (which is where EA is based) forced them to block certain countries. Unfortunately you live in one of those countries. I'm sorry but there is nothing we ca do here to allow you access again.\\\" So I'm making a (hopefully pretty safe) assumption that it's because of sanctions.\\n\\nNone of us has been offered a refund - not even a \\\"sorry, all your games are gone.\\\" \\n\\nRemember, if they do it to me, they can do it to you too. Don't use or buy games from Origin or DRM services. They can take your content away without offering a refund.\\n\\nEdit: I feel like this is something that the entire gaming community needs to know about - I don't think that revoking access to an entire country's worth of people's paid content is something that should happen quietly. PLEASE spread the word about this. We in Myanmar need your help to get our games back!\\n\\nEdit edit: Wow, this blew up to #1 on the frontpage. Although I probably shouldn't be surprised since EA + DRM + getting games pulled is a Reddit recipe for success. Since it's blown up so much, I feel the need to clarify a few things that I now realize are not clear from the comments.\\n\\n1. I live in Myanmar, but I am not from Myanmar.\\n2. My account was not started in Myanmar (though several of my friends' accounts were, and they are having the same problem).\\n3. Origin is kicking an \\\"Access Denied\\\" message to all of us. You can't access ANY games or even see the store. Click the links above for examples. If we use VPNs, we can circumvent this and access our games (although we can't play online due to insane ping - baseline here is 100ms; you use a VPN you go to 350+).\\n4. Myanmar's sanctions were lifted on October 7th. For those of you that say EA has no choice, they do. \\n5. We were all able to access Origin in early September. Obama announced that the sanctions were being lifted from Myanmar. Right around the time of the announcement, EA terminates all Myanmar access to Origin.\\n\\nThis is a much, MUCH bigger problem than just a few gamers in Myanmar. This highlights a crucial element of the TOS of big game companies - the money that you pay them gives you essentially nothing in return, except for an empty promise that the game company may let you play their game until they decide you can't. \\n\\nEdit edit edit: I'm waiting on the \\\"Thank you for contacting EA\\\" screen. My wait time is under 5 minutes!\\n\\nEdit edit edit edit: It's been 20 minutes. But the good news is my wait time is STILL under 5 minutes!\\n\\nEdit^5: No \\\"experts\\\" available, so they can't give me a definitive answer today. They'll have to get back to me tomorrow.\", \"likes\": null, \"suggested_sort\": null, \"user_reports\": [], \"secure_media\": null, \"saved\": false, \"id\": \"5a51e2\", \"gilded\": 4, \"secure_media_embed\": {}, \"clicked\": false, \"report_reasons\": null, \"author\": \"trivial_sublime\", \"media\": null, \"name\": \"t3_5a51e2\", \"score\": 6559, \"approved_by\": null, \"over_18\": false, \"removal_reason\": null, \"hidden\": false, \"preview\": {\"images\": [{\"source\": {\"url\": \"https://i.redditmedia.com/08_cFIe3ZSBRAgfzvNjqWgRKTPy_VbUiX9cOzvHWMBc.jpg?s=8ce6185dc09a51c281e3c21209757927\", \"width\": 83, \"height\": 83}, \"resolutions\": [], \"variants\": {}, \"id\": \"PdCrP3KLlfTXDCGILkm-rdP88x0WkvzLSYh4M2oIsD4\"}]}, \"thumbnail\": \"self\", \"subreddit_id\": \"t5_2qh03\", \"edited\": 1477836158.0, \"link_flair_css_class\": null, \"author_flair_css_class\": null, \"downs\": 0, \"mod_reports\": [], \"archived\": false, \"media_embed\": {}, \"post_hint\": \"self\", \"is_self\": true, \"hide_score\": false, \"spoiler\": false, \"permalink\": \"/r/gaming/comments/5a51e2/ea_games_and_origin_quietly_bans_an_entire/\", \"locked\": false, \"stickied\": false, \"created\": 1477841234.0, \"url\": \"https://www.reddit.com/r/gaming/comments/5a51e2/ea_games_and_origin_quietly_bans_an_entire/\", \"author_flair_text\": null, \"quarantine\": false, \"title\": \"EA Games and Origin quietly bans an entire country - or, why you shouldn't take digital distribution for granted.\", \"created_utc\": 1477812434.0, \"link_flair_text\": null, \"distinguished\": null, \"num_comments\": 3194, \"visited\": false, \"num_reports\": null, \"ups\": 6559}}, {\"kind\": \"t3\", \"data\": {\"contest_mode\": false, \"banned_by\": null, \"domain\": \"en.wikipedia.org\", \"subreddit\": \"todayilearned\", \"selftext_html\": null, \"selftext\": \"\", \"likes\": null, \"suggested_sort\": null, \"user_reports\": [], \"secure_media\": null, \"saved\": false, \"id\": \"5a75wq\", \"gilded\": 0, \"secure_media_embed\": {}, \"clicked\": false, \"report_reasons\": null, \"author\": \"jopperr44\", \"media\": null, \"name\": \"t3_5a75wq\", \"score\": 7116, \"approved_by\": null, \"over_18\": false, \"removal_reason\": null, \"hidden\": false, \"preview\": {\"images\": [{\"source\": {\"url\": \"https://i.redditmedia.com/9ZQI-WSSNRlNS3SlpvbpMJzTT7ngSDMgrLLQ6Qjyzp0.jpg?s=3396c1220d96242482a5ebb9fb932917\", \"width\": 220, \"height\": 323}, \"resolutions\": [{\"url\": \"https://i.redditmedia.com/9ZQI-WSSNRlNS3SlpvbpMJzTT7ngSDMgrLLQ6Qjyzp0.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;s=9c7e12016f76f40a0f60a33e65e03558\", \"width\": 108, \"height\": 158}, {\"url\": \"https://i.redditmedia.com/9ZQI-WSSNRlNS3SlpvbpMJzTT7ngSDMgrLLQ6Qjyzp0.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;s=928128fbbbd5ab51d680cfd66596e0d2\", \"width\": 216, \"height\": 317}], \"variants\": {}, \"id\": \"Q5eMbmuULzQW9INTr6clUHAEp-p6NfvsoqyPcGIzAF0\"}]}, \"thumbnail\": \"http://b.thumbs.redditmedia.com/9kDxW6B1IpcvVHntJ90pp5l9I2wAa7ljjmB5pP1XImk.jpg\", \"subreddit_id\": \"t5_2qqjc\", \"edited\": false, \"link_flair_css_class\": null, \"author_flair_css_class\": null, \"downs\": 0, \"mod_reports\": [], \"archived\": false, \"media_embed\": {}, \"post_hint\": \"link\", \"is_self\": false, \"hide_score\": false, \"spoiler\": false, \"permalink\": \"/r/todayilearned/comments/5a75wq/til_that_after_norway_banned_life_of_brian_for/\", \"locked\": false, \"stickied\": false, \"created\": 1477877828.0, \"url\": \"https://en.wikipedia.org/wiki/Monty_Python%27s_Life_of_Brian\", \"author_flair_text\": null, \"quarantine\": false, \"title\": \"TIL that after Norway banned Life of Brian for blasphemy, it was marketed in Sweden as \\\"The film that is so funny that it was banned in Norway!\\\"\", \"created_utc\": 1477849028.0, \"link_flair_text\": null, \"distinguished\": null, \"num_comments\": 1719, \"visited\": false, \"num_reports\": null, \"ups\": 7116}}, {\"kind\": \"t3\", \"data\": {\"contest_mode\": false, \"banned_by\": null, \"domain\": \"i.imgur.com\", \"subreddit\": \"aww\", \"selftext_html\": null, \"selftext\": \"\", \"likes\": null, \"suggested_sort\": null, \"user_reports\": [], \"secure_media\": null, \"saved\": false, \"id\": \"5a4w2q\", \"gilded\": 0, \"secure_media_embed\": {}, \"clicked\": false, \"report_reasons\": null, \"author\": \"awkwardtheturtle\", \"media\": null, \"name\": \"t3_5a4w2q\", \"score\": 6418, \"approved_by\": null, \"over_18\": false, \"removal_reason\": null, \"hidden\": false, \"preview\": {\"images\": [{\"source\": {\"url\": \"https://i.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fm=jpg&amp;s=12719e7bd88a46b507b03cfeb9e3a936\", \"width\": 720, \"height\": 900}, \"resolutions\": [{\"url\": \"https://i.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;fm=jpg&amp;s=762588067158c6497ec11bac7dad1b57\", \"width\": 108, \"height\": 135}, {\"url\": \"https://i.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;fm=jpg&amp;s=d852fb91bcc73aa09dd80626171e3ee1\", \"width\": 216, \"height\": 270}, {\"url\": \"https://i.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=320&amp;fm=jpg&amp;s=27c56c19bbc873415c2021c5fa1b546e\", \"width\": 320, \"height\": 400}, {\"url\": \"https://i.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=640&amp;fm=jpg&amp;s=ee69f3b073d5af4f16ac4fa16fece55b\", \"width\": 640, \"height\": 800}], \"variants\": {\"gif\": {\"source\": {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?s=92a221b63ecb47c1ef19a5361db3185d\", \"width\": 720, \"height\": 900}, \"resolutions\": [{\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;s=ee6bd89c8e262f2659ec891f1866d109\", \"width\": 108, \"height\": 135}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;s=f4c5e3f3a234bdcecdb2d8d2e0bc48b6\", \"width\": 216, \"height\": 270}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=320&amp;s=cb40ecca756dd19033fd2519564651e6\", \"width\": 320, \"height\": 400}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=640&amp;s=0f51018182a466a1e2d479c8e2f83036\", \"width\": 640, \"height\": 800}]}, \"mp4\": {\"source\": {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fm=mp4&amp;mp4-fragmented=false&amp;s=3797d5cf5bd44157df778538a66857c9\", \"width\": 720, \"height\": 900}, \"resolutions\": [{\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;fm=mp4&amp;mp4-fragmented=false&amp;s=34b62884828806942589fa175bf9d85b\", \"width\": 108, \"height\": 135}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;fm=mp4&amp;mp4-fragmented=false&amp;s=b24d619e243ae97360a446d1d47c8694\", \"width\": 216, \"height\": 270}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=320&amp;fm=mp4&amp;mp4-fragmented=false&amp;s=e3ae9e41852ccfd613405706890c0040\", \"width\": 320, \"height\": 400}, {\"url\": \"https://g.redditmedia.com/935Yt_8GWEq-hNZp_svotdPIAWvvGxSVqTgVA8I5YyA.gif?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=640&amp;fm=mp4&amp;mp4-fragmented=false&amp;s=685b8da1089d9cdba57aa78ca68e7b84\", \"width\": 640, \"height\": 800}]}}, \"id\": \"_uZPCbmhwOff_ug3FyUCGLPfRkmPyn4yv6FlssHGxtA\"}]}, \"thumbnail\": \"http://b.thumbs.redditmedia.com/dbX32e4qBQzEGacHeJw89AWAJ9m7mOX_tQgogiEiHdw.jpg\", \"subreddit_id\": \"t5_2qh1o\", \"edited\": false, \"link_flair_css_class\": null, \"author_flair_css_class\": null, \"downs\": 0, \"mod_reports\": [], \"archived\": false, \"media_embed\": {}, \"post_hint\": \"link\", \"is_self\": false, \"hide_score\": false, \"spoiler\": false, \"permalink\": \"/r/aww/comments/5a4w2q/the_biggest_yawn_from_the_smallest_bulldog/\", \"locked\": false, \"stickied\": false, \"created\": 1477837866.0, \"url\": \"http://i.imgur.com/eqLa2Lf.gifv\", \"author_flair_text\": null, \"quarantine\": false, \"title\": \"The biggest yawn from the smallest bulldog\", \"created_utc\": 1477809066.0, \"link_flair_text\": null, \"distinguished\": null, \"num_comments\": 308, \"visited\": false, \"num_reports\": null, \"ups\": 6418}}, {\"kind\": \"t3\", \"data\": {\"contest_mode\": false, \"banned_by\": null, \"domain\": \"rt.com\", \"subreddit\": \"worldnews\", \"selftext_html\": null, \"selftext\": \"\", \"likes\": null, \"suggested_sort\": null, \"user_reports\": [], \"secure_media\": null, \"saved\": false, \"id\": \"5a4y6z\", \"gilded\": 0, \"secure_media_embed\": {}, \"clicked\": false, \"report_reasons\": null, \"author\": \"KRISHNA53\", \"media\": null, \"name\": \"t3_5a4y6z\", \"score\": 6261, \"approved_by\": null, \"over_18\": false, \"removal_reason\": null, \"hidden\": false, \"preview\": {\"images\": [{\"source\": {\"url\": \"https://i.redditmedia.com/vA3bIaIsDaVqgdZpUYjRfePR5c6F1y1V99nGK8I2QSU.jpg?s=8ea5c66232e77f0740d9afde8e185844\", \"width\": 900, \"height\": 472}, \"resolutions\": [{\"url\": \"https://i.redditmedia.com/vA3bIaIsDaVqgdZpUYjRfePR5c6F1y1V99nGK8I2QSU.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=108&amp;s=51dc0c2ee620b1f95c9d932b4ce32a87\", \"width\": 108, \"height\": 56}, {\"url\": \"https://i.redditmedia.com/vA3bIaIsDaVqgdZpUYjRfePR5c6F1y1V99nGK8I2QSU.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=216&amp;s=67c2738191ec7b7313a22981610241c2\", \"width\": 216, \"height\": 113}, {\"url\": \"https://i.redditmedia.com/vA3bIaIsDaVqgdZpUYjRfePR5c6F1y1V99nGK8I2QSU.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=320&amp;s=5d78b06deb7761e66eb4e31523f0b5fd\", \"width\": 320, \"height\": 167}, {\"url\": \"https://i.redditmedia.com/vA3bIaIsDaVqgdZpUYjRfePR5c6F1y1V99nGK8I2QSU.jpg?fit=crop&amp;crop=faces%2Centropy&amp;arh=2&amp;w=640&amp;s=725e835329dc4e979862b4e3ceb81721\", \"width\": 640, \"height\": 335}], \"variants\": {}, \"id\": \"HueWk4K9o9fomJ7aot3uui85yDwywVIzaTrnPaVXYYg\"}]}, \"thumbnail\": \"default\", \"subreddit_id\": \"t5_2qh13\", \"edited\": false, \"link_flair_css_class\": \"normal\", \"author_flair_css_class\": null, \"downs\": 0, \"mod_reports\": [], \"archived\": false, \"media_embed\": {}, \"post_hint\": \"link\", \"is_self\": false, \"hide_score\": false, \"spoiler\": false, \"permalink\": \"/r/worldnews/comments/5a4y6z/71_magnitude_earthquake_strikes_central_italy/\", \"locked\": false, \"stickied\": false, \"created\": 1477839199.0, \"url\": \"https://www.rt.com/news/364721-italy-central-quake-damage/\", \"author_flair_text\": null, \"quarantine\": false, \"title\": \"7.1 magnitude earthquake strikes central Italy\", \"created_utc\": 1477810399.0, \"link_flair_text\": \"Downgraded to 6.6\", \"distinguished\": null, \"num_comments\": 1442, \"visited\": false, \"num_reports\": null, \"ups\": 6261}}], \"after\": \"t3_5a4y6z\", \"before\": null}}";

    private Backend() {
    }

    public static Backend getInstance() {
        return ourInstance;
    }

    private String PerformRequest(String restMethod) throws IOException {

        return response;
    }


    private PostModel parsePost(JsonObject postJson) {
        PostModel p = new PostModel();
        p.setAuthor(postJson.get("author").getAsString());
        p.setCreatedOn(postJson.get("created").getAsString());
        p.setTitle(postJson.get("title").getAsString());
        p.setComments(postJson.get("num_comments").getAsInt());
        JsonObject preview = postJson.getAsJsonObject("preview");
        JsonArray images = preview.getAsJsonArray("images");
        JsonObject arrayObject = images.get(0).getAsJsonObject();
        JsonObject source = arrayObject.getAsJsonObject("source");
        String url = source.get("url").getAsString();
        p.setImageUrl(url);
        return p;


    }

    public List<PostModel> getTopPosts() {
        List<PostModel> list = new ArrayList<PostModel>();
        try {
            String jsonRaw = PerformRequest(END_POINT + "top.json");
            JsonParser parser = new JsonParser();
            JsonElement jElement = parser.parse(jsonRaw);
            if (jElement.isJsonObject()) {
                JsonObject data = jElement.getAsJsonObject().get("data").getAsJsonObject();
                JsonArray children = data.getAsJsonObject().get("children").getAsJsonArray();
                for (int i = 0; i < children.size(); i++) {
                    JsonObject childrenArrayElement = children.get(i).getAsJsonObject();
                    JsonObject childrenData = childrenArrayElement.get("data").getAsJsonObject();
                    list.add(parsePost(childrenData));
                }

            }

        } catch (IOException exception) {
            exception.printStackTrace();
        }
        return list;
    }
}
